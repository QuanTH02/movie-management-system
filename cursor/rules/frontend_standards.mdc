---
alwaysApply: true
---

# Frontend Coding Standards - Next.js + TypeScript + React

## Tá»•ng Quan

File nÃ y Ä‘á»‹nh nghÄ©a cÃ¡c quy táº¯c vÃ  chuáº©n má»±c láº­p trÃ¬nh báº¯t buá»™c pháº£i tuÃ¢n thá»§ khi phÃ¡t triá»ƒn frontend cá»§a dá»± Ã¡n. Táº¥t cáº£ cÃ¡c developer vÃ  AI Ä‘á»u pháº£i tuÃ¢n thá»§ cÃ¡c quy táº¯c nÃ y má»™t cÃ¡ch nghiÃªm ngáº·t.

## 1. âš™ï¸ Quy Táº¯c Cáº¥u TrÃºc Dá»± Ãn (Project Structure)

### 1.1. Cáº¥u TrÃºc ThÆ° Má»¥c ChÃ­nh

Dá»± Ã¡n sá»­ dá»¥ng **Next.js 14 App Router**, cáº¥u trÃºc thÆ° má»¥c pháº£i tuÃ¢n theo chuáº©n sau:

```
Film_FE/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ (guest)/                  # Route groups cho guest users
â”‚   â”œâ”€â”€ (loggedin)/               # Route groups cho authenticated users
â”‚   â”‚   â”œâ”€â”€ content/              # Feature-based routing
â”‚   â”‚   â”œâ”€â”€ editor-function/
â”‚   â”‚   â”œâ”€â”€ setting/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ components/               # Shared components
â”‚   â”‚   â”œâ”€â”€ common/               # Reusable UI components
â”‚   â”‚   â”‚   â”œâ”€â”€ Button/
â”‚   â”‚   â”‚   â”œâ”€â”€ Form/
â”‚   â”‚   â”‚   â”œâ”€â”€ Icon/
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ [FeatureName]/        # Feature-specific components
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ lib/                      # Utilities vÃ  business logic
â”‚   â”‚   â”œâ”€â”€ api/                  # API layer
â”‚   â”‚   â”‚   â”œâ”€â”€ generated/        # Auto-generated API client
â”‚   â”‚   â”‚   â””â”€â”€ hooks/            # Custom SWR hooks
â”‚   â”‚   â”œâ”€â”€ utils/                # Utility functions
â”‚   â”‚   â””â”€â”€ zods/                 # Zod schemas cho validation
â”‚   â”œâ”€â”€ layout.tsx                # Root layout
â”‚   â””â”€â”€ ...
â”œâ”€â”€ src/                          # Static assets vÃ  legacy code
â”‚   â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ constants/
â”‚   â””â”€â”€ views/
â”œâ”€â”€ public/                       # Static files
â”œâ”€â”€ types/                        # Global TypeScript types
â””â”€â”€ ...
```

### 1.2. Quy Táº¯c Äáº·t TÃªn ThÆ° Má»¥c

- **Route Groups**: Sá»­ dá»¥ng `(groupName)` cho route groups (vÃ­ dá»¥: `(loggedin)`, `(guest)`)
- **Feature Folders**: Sá»­ dá»¥ng **kebab-case** cho tÃªn thÆ° má»¥c feature (vÃ­ dá»¥: `content/writing`, `editor-function`)
- **Component Folders**: Sá»­ dá»¥ng **PascalCase** cho thÆ° má»¥c component (vÃ­ dá»¥: `Button/`, `CreateProjectDialog/`)
- **Utility Folders**: Sá»­ dá»¥ng **camelCase** hoáº·c **kebab-case** (vÃ­ dá»¥: `api/hooks/`, `utils/`)

### 1.3. Barrel Files (index.ts/js)

**Báº®T BUá»˜C** sá»­ dá»¥ng barrel files cho cÃ¡c thÆ° má»¥c cÃ³ nhiá»u exports:

```typescript
// âœ… ÄÃšNG: app/components/common/Button/index.ts
export { default } from './Button';
export type { ButtonProps } from './Button';

// âœ… ÄÃšNG: app/lib/utils/index.ts
export { formatDate } from './date';
export { validateEmail } from './validation';
export { debounce } from './performance';

// âŒ SAI: Import trá»±c tiáº¿p tá»« file component
import Button from './Button/Button'; // KhÃ´ng Ä‘Æ°á»£c phÃ©p
```

**Quy táº¯c:**
- Táº¡o `index.ts` trong má»—i thÆ° má»¥c component/utility cÃ³ nhiá»u exports
- Export default component vÃ  named exports cho types
- KhÃ´ng export tá»« barrel file náº¿u chá»‰ cÃ³ 1 file trong thÆ° má»¥c

### 1.4. File Naming Conventions

- **Components**: `PascalCase.tsx` (vÃ­ dá»¥: `Button.tsx`, `CreateProjectDialog.tsx`)
- **Hooks**: `camelCase.ts` vá»›i prefix `use` (vÃ­ dá»¥: `useCreateProject.ts`, `useGetProjectsList.ts`)
- **Utils**: `camelCase.ts` (vÃ­ dá»¥: `formatDate.ts`, `validateEmail.ts`)
- **Types**: `camelCase.ts` hoáº·c `types.ts` (vÃ­ dá»¥: `api.types.ts`)
- **Constants**: `camelCase.ts` (vÃ­ dá»¥: `headingCode.ts`, `roleCode.ts`)
- **Pages**: `page.tsx` (Next.js App Router convention)

## 2. âš›ï¸ Quy Táº¯c ThÃ nh Pháº§n (Component Rules)

### 2.1. Functional Components vá»›i Hooks

**Báº®T BUá»˜C** sá»­ dá»¥ng Functional Components vá»›i React Hooks. **KHÃ”NG BAO GIá»œ** sá»­ dá»¥ng Class Components.

```typescript
// âœ… ÄÃšNG: Functional Component
interface ButtonProps {
  onClick?: () => void;
  children: React.ReactNode;
}

function Button({ onClick, children }: ButtonProps) {
  return <button onClick={onClick}>{children}</button>;
}

export default Button;

// âŒ SAI: Class Component - KHÃ”NG ÄÆ¯á»¢C PHÃ‰P
class Button extends React.Component {
  // ...
}
```

### 2.2. Äáº·t TÃªn Component

- **Component Name**: **PascalCase** (vÃ­ dá»¥: `CreateProjectDialog`, `TaskDetailComponent`)
- **File Name**: Pháº£i khá»›p vá»›i tÃªn component (vÃ­ dá»¥: `CreateProjectDialog.tsx`)
- **Default Export**: Component chÃ­nh pháº£i lÃ  default export
- **Named Exports**: Chá»‰ export types/interfaces nhÆ° named exports

```typescript
// âœ… ÄÃšNG
interface CreateProjectDialogProps {
  isOpen: boolean;
  onClose: () => void;
}

function CreateProjectDialog({ isOpen, onClose }: CreateProjectDialogProps) {
  // ...
}

export default CreateProjectDialog;
export type { CreateProjectDialogProps };

// âŒ SAI
export function CreateProjectDialog() { } // KhÃ´ng dÃ¹ng named export cho component
```

### 2.3. Props vÃ  TypeScript

**Báº®T BUá»˜C** Ä‘á»‹nh nghÄ©a Props interface vá»›i TypeScript. **KHÃ”NG** sá»­ dá»¥ng `any` hoáº·c `PropTypes`.

```typescript
// âœ… ÄÃšNG: Explicit TypeScript interface
interface ButtonProps {
  className?: string;
  disabled?: boolean;
  type?: "submit" | "reset" | "button";
  onClick?: () => void;
  children?: React.ReactNode;
  loading?: boolean;
}

function Button({
  className,
  disabled = false,
  type = "button",
  onClick,
  children,
  loading = false,
}: ButtonProps) {
  // ...
}

// âŒ SAI: Sá»­ dá»¥ng any
function Button(props: any) { }

// âŒ SAI: Sá»­ dá»¥ng PropTypes
Button.propTypes = { ... };
```

**Quy táº¯c Props:**
- **Destructuring**: LuÃ´n destructure props trong function signature
- **Default Values**: Sá»­ dá»¥ng default parameters cho optional props
- **Optional Props**: ÄÃ¡nh dáº¥u báº±ng `?` trong interface
- **Readonly**: Sá»­ dá»¥ng `readonly` cho props khÃ´ng nÃªn mutate

### 2.4. Client Components

**Báº®T BUá»˜C** thÃªm `"use client"` directive cho components sá»­ dá»¥ng:
- React Hooks (useState, useEffect, etc.)
- Event handlers (onClick, onChange, etc.)
- Browser APIs (localStorage, window, etc.)
- Third-party client libraries

```typescript
// âœ… ÄÃšNG
"use client";

import { useState } from "react";

function InteractiveComponent() {
  const [count, setCount] = useState(0);
  return <button onClick={() => setCount(count + 1)}>{count}</button>;
}

// âŒ SAI: Thiáº¿u "use client" directive
function InteractiveComponent() {
  const [count, setCount] = useState(0); // Lá»—i: useState chá»‰ dÃ¹ng trong Client Component
}
```

### 2.5. TÃ¡ch Logic vá»›i Custom Hooks

**Báº®T BUá»˜C** tÃ¡ch logic phá»©c táº¡p sang Custom Hooks khi:
- Logic Ä‘Æ°á»£c sá»­ dá»¥ng láº¡i á»Ÿ nhiá»u components
- Component cÃ³ quÃ¡ nhiá»u state/hooks (> 5 hooks)
- Logic liÃªn quan Ä‘áº¿n API calls hoáº·c side effects

```typescript
// âœ… ÄÃšNG: TÃ¡ch logic sang custom hook
// app/lib/hooks/useProjectForm.ts
export function useProjectForm(initialData?: Project) {
  const [formData, setFormData] = useState(initialData);
  const [errors, setErrors] = useState<Record<string, string>>({});

  const validate = useCallback(() => {
    // Validation logic
  }, [formData]);

  return { formData, setFormData, errors, validate };
}

// Component sá»­ dá»¥ng hook
function CreateProjectDialog() {
  const { formData, setFormData, errors, validate } = useProjectForm();
  // ...
}

// âŒ SAI: Logic phá»©c táº¡p náº±m trá»±c tiáº¿p trong component
function CreateProjectDialog() {
  const [formData, setFormData] = useState({});
  const [errors, setErrors] = useState({});
  // 50+ dÃ²ng validation logic...
}
```

**Quy táº¯c Custom Hooks:**
- **Naming**: Báº¯t Ä‘áº§u vá»›i `use` (vÃ­ dá»¥: `useProjectForm`, `useApiData`)
- **Location**: Äáº·t trong `app/lib/hooks/` hoáº·c `app/lib/api/hooks/`
- **Return Type**: LuÃ´n Ä‘á»‹nh nghÄ©a return type rÃµ rÃ ng
- **Documentation**: ThÃªm JSDoc cho hooks phá»©c táº¡p

### 2.6. Styling

Dá»± Ã¡n sá»­ dá»¥ng **Ä‘a phÆ°Æ¡ng thá»©c styling**, Æ°u tiÃªn theo thá»© tá»±:

#### 2.6.1. Tailwind CSS (Æ¯u tiÃªn cao nháº¥t)

**Báº®T BUá»˜C** sá»­ dá»¥ng Tailwind CSS cho styling má»›i. Sá»­ dá»¥ng utility classes:

```typescript
// âœ… ÄÃšNG: Sá»­ dá»¥ng Tailwind classes
function Button({ className, children }: ButtonProps) {
  return (
    <button
      className={clsx(
        "hover:!bg-opacity-90 text-sm h-[40px]",
        "flex items-center justify-center",
        className
      )}
    >
      {children}
    </button>
  );
}

// âŒ SAI: Inline styles hoáº·c CSS modules khÃ´ng cáº§n thiáº¿t
<button style={{ height: '40px' }}> // KhÃ´ng Ä‘Æ°á»£c phÃ©p
```

**Quy táº¯c Tailwind:**
- Sá»­ dá»¥ng `clsx` hoáº·c `cn` utility Ä‘á»ƒ merge classes
- Táº¡o custom classes trong `tailwind.config.ts` cho design tokens
- Sá»­ dá»¥ng responsive prefixes (`sm:`, `md:`, `lg:`) cho responsive design
- TrÃ¡nh arbitrary values trá»« khi thá»±c sá»± cáº§n thiáº¿t

#### 2.6.2. Emotion (CSS-in-JS) - Cho dynamic styling

Sá»­ dá»¥ng Emotion khi cáº§n:
- Dynamic styles dá»±a trÃªn props/state
- Theming phá»©c táº¡p
- Styled components vá»›i logic phá»©c táº¡p

```typescript
// âœ… ÄÃšNG: Sá»­ dá»¥ng Emotion cho dynamic styling
import styled from '@emotion/styled';

const StyledButton = styled.button<{ variant: 'primary' | 'secondary' }>`
  background-color: ${props =>
    props.variant === 'primary' ? '#007bff' : '#6c757d'};
  padding: 0.5rem 1rem;
`;
```

#### 2.6.3. CSS Modules - Chá»‰ cho legacy code

**KHÃ”NG** táº¡o CSS modules má»›i. Chá»‰ maintain code cÅ©.

### 2.7. Component Size vÃ  Single Responsibility Principle (SRP)

**Báº®T BUá»˜C** tuÃ¢n thá»§ nguyÃªn táº¯c SRP: má»—i component chá»‰ lÃ m má»™t nhiá»‡m vá»¥.

**Quy táº¯c:**
- **JSX markup khÃ´ng quÃ¡ 50 dÃ²ng**: Náº¿u JSX vÆ°á»£t quÃ¡ 50 dÃ²ng, **Báº®T BUá»˜C** tÃ¡ch thÃ nh sub-components
- **Component nhá» gá»n**: Dá»… báº£o trÃ¬, hiá»‡u nÄƒng tá»‘t, dá»… tÃ¡i sá»­ dá»¥ng
- **TÃ¡ch logic**: Logic phá»©c táº¡p pháº£i tÃ¡ch sang custom hooks hoáº·c utility functions

```typescript
// âŒ SAI: Component quÃ¡ dÃ i vá»›i JSX > 50 dÃ²ng
function UserProfile({ user }: { user: User }) {
  return (
    <div>
      {/* 100+ dÃ²ng JSX... */}
    </div>
  );
}

// âœ… ÄÃšNG: TÃ¡ch thÃ nh sub-components
function UserProfile({ user }: { user: User }) {
  return (
    <div>
      <UserHeader user={user} />
      <UserDetails user={user} />
      <UserActions user={user} />
    </div>
  );
}

function UserHeader({ user }: { user: User }) {
  return (
    <div>
      {/* < 50 dÃ²ng JSX */}
    </div>
  );
}
```

**Khi nÃ o cáº§n tÃ¡ch component:**
- JSX markup > 50 dÃ²ng
- Component cÃ³ nhiá»u responsibilities (> 3 concerns)
- Logic phá»©c táº¡p cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng
- Component cÃ³ quÃ¡ nhiá»u props (> 7 props)

### 2.8. Memoization & Performance

Sá»­ dá»¥ng memoization má»™t cÃ¡ch **há»£p lÃ½**, khÃ´ng láº¡m dá»¥ng:

#### 2.8.1. React.memo

Sá»­ dá»¥ng `React.memo` cho components:
- Render thÆ°á»ng xuyÃªn vá»›i cÃ¹ng props
- Component lá»›n vá»›i nhiá»u children
- Component trong list render nhiá»u láº§n

```typescript
// âœ… ÄÃšNG: Memo cho component render nhiá»u láº§n
interface ItemProps {
  id: number;
  name: string;
  onClick: (id: number) => void;
}

const ListItem = React.memo(function ListItem({ id, name, onClick }: ItemProps) {
  return (
    <div onClick={() => onClick(id)}>
      {name}
    </div>
  );
});

// âŒ SAI: Memo khÃ´ng cáº§n thiáº¿t cho component Ä‘Æ¡n giáº£n
const SimpleButton = React.memo(function SimpleButton({ text }: { text: string }) {
  return <button>{text}</button>; // KhÃ´ng cáº§n memo
});
```

#### 2.8.2. useMemo

Sá»­ dá»¥ng `useMemo` cho:
- TÃ­nh toÃ¡n phá»©c táº¡p (> 100ms)
- Derived state tá»« props phá»©c táº¡p
- Object/Array Ä‘Æ°á»£c truyá»n nhÆ° props

```typescript
// âœ… ÄÃšNG: useMemo cho tÃ­nh toÃ¡n phá»©c táº¡p
function DataTable({ data }: { data: Data[] }) {
  const sortedData = useMemo(() => {
    return data.sort((a, b) => a.date - b.date); // Expensive operation
  }, [data]);

  return <table>{/* ... */}</table>;
}

// âŒ SAI: useMemo khÃ´ng cáº§n thiáº¿t
const doubled = useMemo(() => count * 2, [count]); // QuÃ¡ Ä‘Æ¡n giáº£n
```

#### 2.8.3. useCallback

Sá»­ dá»¥ng `useCallback` cho:
- Functions Ä‘Æ°á»£c truyá»n nhÆ° props cho memoized components
- Functions trong dependency arrays cá»§a hooks khÃ¡c
- Event handlers trong list items

```typescript
// âœ… ÄÃšNG: useCallback cho function props
function Parent() {
  const handleClick = useCallback((id: number) => {
    // Handle click
  }, []);

  return <MemoizedChild onClick={handleClick} />;
}

// âŒ SAI: useCallback khÃ´ng cáº§n thiáº¿t
const handleClick = useCallback(() => {
  console.log('click'); // QuÃ¡ Ä‘Æ¡n giáº£n, khÃ´ng cáº§n memo
}, []);
```

#### 2.8.4. Hook Dependencies

**Báº®T BUá»˜C** kiá»ƒm tra dependencies cá»§a `useEffect`, `useCallback`, `useMemo`:

**Vá»›i `useEffect`**: Chá»‰ cÃ³ **2 cÃ¡ch Ä‘Ãºng** Ä‘á»ƒ setup dependencies:

1. **Include táº¥t cáº£ dependencies**: LuÃ´n thÃªm táº¥t cáº£ dependencies náº¿u Ä‘ang update state trong `useEffect`
2. **Ignore dependencies**: Chá»‰ khi muá»‘n `useEffect` cháº¡y má»™t láº§n khi component mount

```typescript
// âœ… ÄÃšNG: Include táº¥t cáº£ dependencies
useEffect(() => {
  if (userId && projectId) {
    fetchData(userId, projectId);
  }
}, [userId, projectId]); // Táº¥t cáº£ dependencies

// âœ… ÄÃšNG: Cháº¡y má»™t láº§n khi mount
useEffect(() => {
  initializeApp();
}, []); // Empty array = chá»‰ cháº¡y khi mount

// âŒ SAI: Thiáº¿u dependencies
useEffect(() => {
  fetchData(userId, projectId); // userId, projectId khÃ´ng trong deps
}, []); // Sáº½ cÃ³ stale closure

// âŒ SAI: Dependencies khÃ´ng Ä‘áº§y Ä‘á»§
useEffect(() => {
  if (user?.id) {
    fetchData(user.id, projectId);
  }
}, [projectId]); // Thiáº¿u user trong deps
```

**Vá»›i `useCallback`**: Chá»‰ sá»­ dá»¥ng khi:
- Function Ä‘Æ°á»£c truyá»n nhÆ° prop cho memoized component
- Function lÃ  dependency cá»§a hook khÃ¡c (`useEffect`, `useMemo`)

```typescript
// âœ… ÄÃšNG: useCallback cho prop cá»§a memoized component
const handleClick = useCallback((id: number) => {
  // ...
}, [dependency]);

<MemoizedChild onClick={handleClick} />

// âŒ SAI: useCallback khÃ´ng cáº§n thiáº¿t
const handleClick = useCallback(() => {
  console.log('click');
}, []); // KhÃ´ng Ä‘Æ°á»£c truyá»n nhÆ° prop, khÃ´ng cáº§n memo
```

**Vá»›i `useMemo`**: Chá»‰ sá»­ dá»¥ng cho:
- TÃ­nh toÃ¡n tá»‘n kÃ©m (> 100ms)
- Object/Array Ä‘Æ°á»£c truyá»n nhÆ° props

```typescript
// âœ… ÄÃšNG: useMemo cho tÃ­nh toÃ¡n tá»‘n kÃ©m
const sortedData = useMemo(() => {
  return largeArray.sort(complexSortFunction);
}, [largeArray]);

// âŒ SAI: useMemo cho tÃ­nh toÃ¡n Ä‘Æ¡n giáº£n
const doubled = useMemo(() => count * 2, [count]); // QuÃ¡ Ä‘Æ¡n giáº£n
```

**Quy táº¯c chung:**
- **Äo lÆ°á»ng trÆ°á»›c khi tá»‘i Æ°u**: Chá»‰ memoize khi cÃ³ váº¥n Ä‘á» performance thá»±c sá»±
- **TrÃ¡nh premature optimization**: KhÃ´ng memoize má»i thá»©
- **Profile**: Sá»­ dá»¥ng React DevTools Profiler Ä‘á»ƒ xÃ¡c Ä‘á»‹nh bottlenecks
- **ESLint**: LuÃ´n sá»­ dá»¥ng `eslint-plugin-react-hooks` Ä‘á»ƒ check dependencies

## 3. ğŸ“ Quy Táº¯c Logic vÃ  Code Styling (Coding Standards)

### 3.1. TypeScript

#### 3.1.1. Strict Typing

**Báº®T BUá»˜C** sá»­ dá»¥ng TypeScript vá»›i explicit typing. **KHÃ”NG** sá»­ dá»¥ng `any`, `unknown` chá»‰ khi thá»±c sá»± cáº§n thiáº¿t.

```typescript
// âœ… ÄÃšNG: Explicit types
interface User {
  id: number;
  name: string;
  email: string;
}

function getUser(id: number): Promise<User> {
  return api.getUser(id);
}

// âŒ SAI: Sá»­ dá»¥ng any
function getUser(id: any): any {
  return api.getUser(id);
}

// âœ… ÄÃšNG: unknown khi cáº§n type safety
function parseJSON(json: string): unknown {
  return JSON.parse(json);
}
```

#### 3.1.2. Type Definitions

- **Interfaces**: Sá»­ dá»¥ng cho object shapes, props, API responses
- **Types**: Sá»­ dá»¥ng cho unions, intersections, utility types
- **Enums**: Sá»­ dá»¥ng cho constants cÃ³ giÃ¡ trá»‹ cá»‘ Ä‘á»‹nh

```typescript
// âœ… ÄÃšNG: Interface cho props
interface ButtonProps {
  onClick?: () => void;
  disabled?: boolean;
}

// âœ… ÄÃšNG: Type cho union
type Status = 'pending' | 'success' | 'error';

// âœ… ÄÃšNG: Enum cho constants
enum HeadingCode {
  H1 = 'h1',
  H2 = 'h2',
  H3 = 'h3',
  H4 = 'h4',
}
```

#### 3.1.3. Import Types

**Báº®T BUá»˜C** sá»­ dá»¥ng `type` keyword cho type-only imports (theo ESLint rule):

```typescript
// âœ… ÄÃšNG: Type-only import
import type { User, Project } from '../lib/api/generated';
import { useGetUser } from '../lib/api/hooks/useGetUser';

// âŒ SAI: Mixed import
import { User, useGetUser } from './api'; // KhÃ´ng Ä‘Æ°á»£c phÃ©p
```

### 3.2. Naming Conventions

#### 3.2.1. Variables vÃ  Functions

- **camelCase** cho variables, functions, methods
- **Descriptive names**: TÃªn pháº£i mÃ´ táº£ rÃµ má»¥c Ä‘Ã­ch

```typescript
// âœ… ÄÃšNG
const userName = 'John';
const isAuthenticated = true;
function getUserById(id: number) { }
function handleSubmit() { }

// âŒ SAI
const u = 'John'; // QuÃ¡ ngáº¯n
const flag = true; // KhÃ´ng mÃ´ táº£
function get() { } // QuÃ¡ chung chung
```

#### 3.2.2. Components vÃ  Types

- **PascalCase** cho Components, Interfaces, Types, Enums

```typescript
// âœ… ÄÃšNG
function CreateProjectDialog() { }
interface UserProfile { }
type ApiResponse = { };
enum UserRole { }

// âŒ SAI
function createProjectDialog() { } // Pháº£i lÃ  PascalCase
```

#### 3.2.3. Constants

- **UPPER_SNAKE_CASE** cho constants toÃ n cá»¥c
- **camelCase** cho constants trong module

```typescript
// âœ… ÄÃšNG: Global constants
const API_BASE_URL = 'https://api.example.com';
const MAX_RETRY_ATTEMPTS = 3;

// âœ… ÄÃšNG: Module constants
const defaultConfig = {
  timeout: 5000,
  retries: 3,
};
```

### 3.3. Constants & Enums

**Báº®T BUá»˜C** sá»­ dá»¥ng `const` vÃ  `enum` (hoáº·c Union Types) cho giÃ¡ trá»‹ cá»‘ Ä‘á»‹nh:

```typescript
// âœ… ÄÃšNG: Enum
enum HeadingCode {
  H1 = 'h1',
  H2 = 'h2',
  H3 = 'h3',
  H4 = 'h4',
}

// âœ… ÄÃšNG: Union Type (preferred cho simple unions)
type Status = 'pending' | 'success' | 'error';

// âœ… ÄÃšNG: Const object
const API_ENDPOINTS = {
  USERS: '/api/users',
  PROJECTS: '/api/projects',
} as const;

// âŒ SAI: Magic strings/numbers
if (status === 'pending') { } // Pháº£i dÃ¹ng constant
```

**Location**: Äáº·t constants trong `src/constants/` hoáº·c `app/lib/constants/`

### 3.4. Conditional Rendering

**Æ¯u tiÃªn** sá»­ dá»¥ng:
1. **Ternary Operator** (`? :`) cho 2 trÆ°á»ng há»£p
2. **Short-Circuiting** (`&&`) cho conditional render
3. **Early Return** trong functions

```typescript
// âœ… ÄÃšNG: Ternary operator
{isLoading ? <Spinner /> : <Content />}

// âœ… ÄÃšNG: Short-circuiting
{isAuthenticated && <Dashboard />}
{error && <ErrorMessage error={error} />}

// âœ… ÄÃšNG: Early return trong function
function renderContent() {
  if (isLoading) return <Spinner />;
  if (error) return <ErrorMessage error={error} />;
  return <Content />;
}

// âŒ SAI: Nested if-else trong JSX
{(() => {
  if (isLoading) {
    return <Spinner />;
  } else {
    if (error) {
      return <ErrorMessage />;
    } else {
      return <Content />;
    }
  }
})()}
```

### 3.5. Hooks Declaration Order

**Báº®T BUá»˜C** khai bÃ¡o hooks á»Ÿ **Ä‘áº§u component**, khÃ´ng Ä‘Æ°á»£c Ä‘áº·t trong:
- Conditional statements (`if`, `switch`)
- Loops (`for`, `while`)
- Nested functions
- Sau cÃ¡c logic cÃ³ thá»ƒ thay Ä‘á»•i trong quÃ¡ trÃ¬nh render

```typescript
// âœ… ÄÃšNG: Hooks á»Ÿ Ä‘áº§u component
function Component({ isVisible }: { isVisible: boolean }) {
  // 1. Táº¥t cáº£ hooks á»Ÿ Ä‘Ã¢y
  const [state, setState] = useState();
  const { data } = useSWR('/api/data');
  useEffect(() => {
    // ...
  }, []);

  // 2. Early returns
  if (!isVisible) return null;

  // 3. Logic vÃ  render
  return <div>{/* ... */}</div>;
}

// âŒ SAI: Hooks trong conditional
function Component({ isVisible }: { isVisible: boolean }) {
  if (!isVisible) return null;

  const [state, setState] = useState(); // âŒ Hook sau conditional
  // ...
}

// âŒ SAI: Hooks trong loop
function Component({ items }: { items: Item[] }) {
  return items.map(item => {
    const [state, setState] = useState(); // âŒ Hook trong loop
    return <div>{/* ... */}</div>;
  });
}

// âœ… ÄÃšNG: TÃ¡ch component náº¿u cáº§n conditional hooks
function ItemComponent({ item }: { item: Item }) {
  const [state, setState] = useState(); // âœ… Hook á»Ÿ Ä‘áº§u
  return <div>{/* ... */}</div>;
}

function Component({ items }: { items: Item[] }) {
  return items.map(item => <ItemComponent key={item.id} item={item} />);
}
```

**LÃ½ do:**
- React yÃªu cáº§u hooks pháº£i Ä‘Æ°á»£c gá»i theo Ä‘Ãºng thá»© tá»± trong má»—i láº§n render
- Hooks trong conditional/loop sáº½ lÃ m thay Ä‘á»•i thá»© tá»± gá»i â†’ gÃ¢y bugs khÃ³ debug
- GiÃºp React tá»‘i Æ°u hÃ³a render vÃ  quáº£n lÃ½ lifecycle hiá»‡u quáº£

### 3.6. Helper Functions vÃ  DRY Principle

**Báº®T BUá»˜C** táº¡o helper functions (common functions) khi:
- Function Ä‘Æ°á»£c sá»­ dá»¥ng láº¡i á»Ÿ nhiá»u nÆ¡i (> 2 láº§n)
- Logic phá»©c táº¡p cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng
- Cáº§n test riÃªng logic Ä‘Ã³

```typescript
// âŒ SAI: Láº·p láº¡i code
function ComponentA() {
  const formatDate = (date: Date) => {
    return `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;
  };
  return <div>{formatDate(new Date())}</div>;
}

function ComponentB() {
  const formatDate = (date: Date) => {
    return `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;
  };
  return <div>{formatDate(new Date())}</div>;
}

// âœ… ÄÃšNG: Táº¡o helper function
// app/lib/utils/date.ts
export function formatDate(date: Date): string {
  return `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;
}

// Components sá»­ dá»¥ng
import { formatDate } from '../lib/utils/date';

function ComponentA() {
  return <div>{formatDate(new Date())}</div>;
}

function ComponentB() {
  return <div>{formatDate(new Date())}</div>;
}
```

**Location**: Äáº·t helper functions trong `app/lib/utils/` hoáº·c `src/utils/`

### 3.7. Cleanup trong useEffect

**Báº®T BUá»˜C** cleanup cÃ¡c resources trong `useEffect`:
- Timers (`setTimeout`, `setInterval`)
- Event listeners
- Subscriptions
- DOM manipulations

```typescript
// âœ… ÄÃšNG: Cleanup timers
useEffect(() => {
  const timeoutId = setTimeout(() => {
    // Do something
  }, 1000);

  return () => clearTimeout(timeoutId); // Cleanup
}, []);

// âœ… ÄÃšNG: Cleanup event listeners
useEffect(() => {
  const handleResize = () => {
    // Handle resize
  };

  window.addEventListener('resize', handleResize);

  return () => {
    window.removeEventListener('resize', handleResize); // Cleanup
  };
}, []);

// âœ… ÄÃšNG: Cleanup subscriptions
useEffect(() => {
  const subscription = observable.subscribe(data => {
    // Handle data
  });

  return () => {
    subscription.unsubscribe(); // Cleanup
  };
}, []);

// âœ… ÄÃšNG: Cleanup DOM manipulations
useEffect(() => {
  const lineChart = document?.querySelector('.lineChartObservationVolume');

  if (lineChart) {
    const timeoutId = setTimeout(() => {
      lineChart.scrollLeft = 100000;
    }, 500);

    return () => clearTimeout(timeoutId); // Cleanup
  }
}, [dataList]);

// âŒ SAI: KhÃ´ng cleanup
useEffect(() => {
  const timeoutId = setTimeout(() => {
    // Do something
  }, 1000);
  // âŒ KhÃ´ng cleanup â†’ memory leak
}, []);
```

### 3.8. Error Handling

**Báº®T BUá»˜C** sá»­ dá»¥ng `try...catch` cho async operations vÃ  log errors rÃµ rÃ ng:

```typescript
// âœ… ÄÃšNG: Error handling vá»›i try-catch
async function fetchUserData(userId: number) {
  try {
    const user = await api.getUser(userId);
    return user;
  } catch (error) {
    console.error('Failed to fetch user:', error);
    // Log to error tracking service (Sentry, etc.)
    throw error; // Re-throw Ä‘á»ƒ component xá»­ lÃ½
  }
}

// âœ… ÄÃšNG: Error handling trong SWR hooks
const { data, error } = useSWR('/api/user', fetcher, {
  onError: (err) => {
    console.error('API Error:', err);
    if (err?.toString()?.includes('401')) {
      signOut({ callbackUrl: '/login' });
    }
  },
});

// âŒ SAI: KhÃ´ng xá»­ lÃ½ error
async function fetchUserData(userId: number) {
  const user = await api.getUser(userId); // CÃ³ thá»ƒ throw error
  return user;
}
```

**Quy táº¯c Error Handling:**
- **Log errors**: LuÃ´n log errors vá»›i context Ä‘áº§y Ä‘á»§
- **User-friendly messages**: Hiá»ƒn thá»‹ message dá»… hiá»ƒu cho user
- **Error boundaries**: Sá»­ dá»¥ng React Error Boundaries cho component errors
- **API errors**: Xá»­ lÃ½ riÃªng cho 401, 403, 500, etc.
- **Cover normal & abnormal cases**: **Báº®T BUá»˜C** xá»­ lÃ½ cáº£ success vÃ  error cases
- **Handle issues in general/logical way**: Xá»­ lÃ½ errors á»Ÿ táº§ng phÃ¹ há»£p (server/client), khÃ´ng xá»­ lÃ½ riÃªng láº» trong tá»«ng component

```typescript
// âŒ SAI: Xá»­ lÃ½ error riÃªng láº» trong component
function Page() {
  const searchParams = useSearchParams();
  const error = searchParams.get('error');
  if (error === 'unauthorized') {
    // Xá»­ lÃ½ unauthorized á»Ÿ Ä‘Ã¢y - SAI
    return <div>Unauthorized</div>;
  }
}

// âœ… ÄÃšNG: Xá»­ lÃ½ á»Ÿ middleware hoáº·c server layer
// middleware.ts hoáº·c layout.tsx
if (error === 'unauthorized') {
  redirect('/login');
}
```

### 3.9. Console vÃ  Debugger

**Báº®T BUá»˜C** loáº¡i bá» táº¥t cáº£ `console.*` vÃ  `debugger` statements trÆ°á»›c khi commit:

```typescript
// âŒ SAI: CÃ³ console vÃ  debugger
function Component() {
  console.log('Debug info');
  console.error('Error');
  debugger; // KhÃ´ng Ä‘Æ°á»£c phÃ©p
  return <div>Content</div>;
}

// âœ… ÄÃšNG: Sá»­ dá»¥ng proper logging hoáº·c xÃ³a háº¿t
function Component() {
  // Sá»­ dá»¥ng error tracking service (Sentry, etc.) thay vÃ¬ console
  // hoáº·c xÃ³a háº¿t console statements
  return <div>Content</div>;
}
```

**Quy táº¯c:**
- **Development**: CÃ³ thá»ƒ dÃ¹ng `console.log` táº¡m thá»i khi debug
- **Before commit**: **Báº®T BUá»˜C** xÃ³a táº¥t cáº£ console statements
- **Production**: Sá»­ dá»¥ng error tracking service (Sentry) thay vÃ¬ console
- **ESLint**: Sá»­ dá»¥ng rule `no-console` vÃ  `no-debugger` Ä‘á»ƒ enforce

### 3.10. ES6+ Features

**Æ¯u tiÃªn** sá»­ dá»¥ng ES6+ features:

```typescript
// âœ… ÄÃšNG: Arrow functions
const handleClick = () => {
  // ...
};

// âœ… ÄÃšNG: Destructuring
const { name, email } = user;
const [first, second] = items;

// âœ… ÄÃšNG: Spread operator
const newUser = { ...user, name: 'Updated' };
const allItems = [...items, newItem];

// âœ… ÄÃšNG: Template literals
const message = `Hello, ${name}!`;

// âœ… ÄÃšNG: Optional chaining
const email = user?.profile?.email;

// âœ… ÄÃšNG: Nullish coalescing
const name = user?.name ?? 'Anonymous';

// âŒ SAI: Old syntax
function handleClick() { } // Arrow function preferred
const name = user && user.profile && user.profile.name; // Use optional chaining
```

## 4. ğŸŒ Quy Táº¯c Giao Tiáº¿p API (API Communication)

### 4.1. API Layer Structure

**Báº®T BUá»˜C** táº­p trung logic API vÃ o cÃ¡c layer riÃªng biá»‡t:

```
app/lib/api/
â”œâ”€â”€ generated/          # Auto-generated API client (OpenAPI)
â”œâ”€â”€ hooks/             # Custom SWR hooks
â””â”€â”€ ...
```

### 4.2. Custom SWR Hooks

**Báº®T BUá»˜C** sá»­ dá»¥ng custom hooks cho táº¥t cáº£ API calls:

```typescript
// âœ… ÄÃšNG: Custom hook pattern
// app/lib/api/hooks/useGetProjectsList.ts
import { signOut } from "next-auth/react";
import type { SWRConfiguration } from "swr";
import useSWR from "swr";
import type { ProjectResponse } from "../generated";
import useApi from "./useApi";

const useGetProjectsList = (options?: SWRConfiguration<ProjectResponse[]>) => {
  const api = useApi();
  const session = useSession();

  return useSWR(
    session.status === "authenticated" && `/api/projects`,
    async () => api.apiApi.apiProjectsList(),
    {
      throwOnError: false,
      ...options,
      onError: (err) => {
        if (err?.toString()?.includes("401")) {
          signOut({ callbackUrl: "/login" });
        }
      },
    },
  );
};

export default useGetProjectsList;

// âœ… ÄÃšNG: Mutation hook pattern
// app/lib/api/hooks/useCreateProject.ts
import type { SWRMutationConfiguration } from "swr/mutation";
import useSWRMutation from "swr/mutation";
import type { ApiApiApiProjectsCreateRequest } from "../generated";
import useApi from "./useApi";

const useCreateProject = (options?: SWRMutationConfiguration<number, any>) => {
  const api = useApi();
  return useSWRMutation(
    "/api/projects",
    async (_: string, { arg }: { arg: ApiApiApiProjectsCreateRequest }) =>
      api.apiApi.apiProjectsCreate(arg),
    {
      throwOnError: false,
      ...options,
      onError: (err) => {
        if (err?.toString()?.includes("401")) {
          signOut({ callbackUrl: "/login" });
        }
      },
    },
  );
};

export default useCreateProject;

// âŒ SAI: Gá»i API trá»±c tiáº¿p trong component
function Component() {
  const [data, setData] = useState();
  useEffect(() => {
    fetch('/api/projects').then(res => res.json()).then(setData); // KhÃ´ng Ä‘Æ°á»£c phÃ©p
  }, []);
}
```

### 4.3. Loading vÃ  Error States

**Báº®T BUá»˜C** xá»­ lÃ½ loading vÃ  error states:

```typescript
// âœ… ÄÃšNG: Xá»­ lÃ½ loading vÃ  error
function ProjectsList() {
  const { data, error, isLoading, mutate } = useGetProjectsList();

  if (isLoading) return <Spinner />;
  if (error) return <ErrorMessage error={error} />;
  if (!data) return null;

  return (
    <div>
      {data.map(project => (
        <ProjectItem key={project.id} project={project} />
      ))}
    </div>
  );
}

// âœ… ÄÃšNG: Mutation vá»›i loading state
function CreateProjectForm() {
  const { trigger, isMutating } = useCreateProject();

  const handleSubmit = async (data: CreateProjectRequest) => {
    await trigger(
      { projectId, createProjectRequest: data },
      {
        onSuccess: () => {
          showSnackBar("Project created successfully");
          mutate(); // Refresh list
        },
        onError: (err) => {
          showSnackBar(undefined, "Failed to create project");
        },
      }
    );
  };

  return (
    <form onSubmit={handleSubmit}>
      <button type="submit" disabled={isMutating}>
        {isMutating ? 'Creating...' : 'Create'}
      </button>
    </form>
  );
}
```

### 4.4. Data Caching vá»›i SWR

SWR tá»± Ä‘á»™ng cache data. **Báº®T BUá»˜C** sá»­ dá»¥ng cÃ¡c options phÃ¹ há»£p:

```typescript
// âœ… ÄÃšNG: SWR configuration
const { data } = useGetProjectsList({
  revalidateOnMount: true,        // Revalidate khi mount
  revalidateOnFocus: true,        // Revalidate khi focus window
  revalidateOnReconnect: true,    // Revalidate khi reconnect
  dedupingInterval: 2000,         // Dedupe requests trong 2s
});

// âœ… ÄÃšNG: Manual revalidation
const { data, mutate } = useGetProjectsList();
// Sau khi create/update, refresh data
mutate();
```

### 4.5. API Error Handling

**Báº®T BUá»˜C** xá»­ lÃ½ cÃ¡c loáº¡i errors:

```typescript
// âœ… ÄÃšNG: Centralized error handling
const ERROR_CODES = {
  NO_ACTION_PERMITTED: "no_action_permitted",
  USAGE_EXPIRED: "usage_expired",
  UNAUTHORIZED: "401",
} as const;

const ERROR_MESSAGES = {
  [ERROR_CODES.NO_ACTION_PERMITTED]: "åˆ©ç”¨æ–‡å­—æ•°ã‚’è¶…éã—ã¦ã„ã¾ã™",
  [ERROR_CODES.USAGE_EXPIRED]: "åˆ©ç”¨æœŸé–“å¤–ã§ã™",
  DEFAULT: "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ãã ã•ã„ã€‚",
};

function handleApiError(error: unknown) {
  const errorMessage = error?.message || error?.toString();

  if (error?.body?.code === ERROR_CODES.NO_ACTION_PERMITTED) {
    return ERROR_MESSAGES[ERROR_CODES.NO_ACTION_PERMITTED];
  }

  if (errorMessage?.includes(ERROR_CODES.UNAUTHORIZED)) {
    signOut({ callbackUrl: "/login" });
    return;
  }

  return ERROR_MESSAGES.DEFAULT;
}
```

## 5. ğŸ£ Quy Táº¯c React Hooks

**LÆ°u Ã½**: CÃ¡c quy táº¯c vá» hooks cÅ©ng Ä‘Æ°á»£c Ä‘á» cáº­p trong section 2 vÃ  3. Section nÃ y tá»•ng há»£p vÃ  chi tiáº¿t hÃ³a cÃ¡c quy táº¯c quan trá»ng nháº¥t.

### 5.1. Hooks Dependencies

**Báº®T BUá»˜C** kiá»ƒm tra dependencies cá»§a `useEffect`, `useCallback`, `useMemo` má»™t cÃ¡ch chÃ­nh xÃ¡c.

#### 5.1.1. useEffect Dependencies

CÃ³ **chá»‰ hai cÃ¡ch Ä‘Ãºng** Ä‘á»ƒ setup `useEffect`:

1. **Include táº¥t cáº£ dependencies**: LuÃ´n thÃªm táº¥t cáº£ dependencies náº¿u Ä‘ang update state trong `useEffect`

```typescript
// âœ… ÄÃšNG: Include táº¥t cáº£ dependencies
function Component({ userId }: { userId: number }) {
  const [user, setUser] = useState<User | null>(null);

  useEffect(() => {
    fetchUser(userId).then(setUser);
  }, [userId]); // Pháº£i include userId

  return <div>{user?.name}</div>;
}

// âŒ SAI: Thiáº¿u dependencies
useEffect(() => {
  fetchUser(userId).then(setUser);
}, []); // Thiáº¿u userId - cÃ³ thá»ƒ gÃ¢y bug
```

2. **Ignore dependencies**: Chá»‰ khi muá»‘n `useEffect` cháº¡y má»™t láº§n khi component mount

```typescript
// âœ… ÄÃšNG: Cháº¡y má»™t láº§n khi mount
useEffect(() => {
  // Setup code chá»‰ cháº¡y má»™t láº§n
  const timer = setInterval(() => {
    // ...
  }, 1000);

  return () => clearInterval(timer);
}, []); // Empty array = chá»‰ cháº¡y khi mount
```

#### 5.1.2. useCallback Dependencies

**Quy táº¯c:**
- Sá»­ dá»¥ng `useCallback` khi function Ä‘Æ°á»£c truyá»n nhÆ° prop cho memoized component
- **Báº®T BUá»˜C** include táº¥t cáº£ dependencies

```typescript
// âœ… ÄÃšNG: useCallback vá»›i Ä‘áº§y Ä‘á»§ dependencies
function Parent() {
  const [count, setCount] = useState(0);
  const [name, setName] = useState('');

  const handleClick = useCallback(() => {
    console.log(count, name); // Sá»­ dá»¥ng count vÃ  name
  }, [count, name]); // Pháº£i include cáº£ count vÃ  name

  return <MemoizedChild onClick={handleClick} />;
}

// âŒ SAI: Thiáº¿u dependencies
const handleClick = useCallback(() => {
  console.log(count, name);
}, [count]); // Thiáº¿u name - cÃ³ thá»ƒ gÃ¢y stale closure
```

#### 5.1.3. useMemo Dependencies

**Quy táº¯c:**
- Sá»­ dá»¥ng `useMemo` Ä‘á»ƒ memoize **values** (khÃ´ng pháº£i functions)
- **Báº®T BUá»˜C** include táº¥t cáº£ dependencies

```typescript
// âœ… ÄÃšNG: useMemo vá»›i Ä‘áº§y Ä‘á»§ dependencies
function Component({ items, filter }: Props) {
  const filteredItems = useMemo(() => {
    return items.filter(item => item.status === filter);
  }, [items, filter]); // Pháº£i include cáº£ items vÃ  filter

  return <List items={filteredItems} />;
}
```

### 5.2. Hooks Pháº£i á» Top cá»§a Component

**Báº®T BUá»˜C** khai bÃ¡o táº¥t cáº£ hooks á»Ÿ Ä‘áº§u component, trÆ°á»›c má»i logic khÃ¡c.

```typescript
// âœ… ÄÃšNG: Hooks á»Ÿ top
function Component({ userId }: { userId: number }) {
  // 1. Táº¥t cáº£ hooks á»Ÿ Ä‘Ã¢y
  const [user, setUser] = useState<User | null>(null);
  const { data } = useSWR(`/api/user/${userId}`);
  const router = useRouter();

  // 2. Derived state / computed values
  const isAuthenticated = !!user;

  // 3. Event handlers
  const handleClick = useCallback(() => {
    // ...
  }, []);

  // 4. Effects
  useEffect(() => {
    // ...
  }, []);

  // 5. Early returns
  if (!isAuthenticated) return null;

  // 6. Render
  return <div>Content</div>;
}

// âŒ SAI: Hooks á»Ÿ giá»¯a component
function Component({ userId }: { userId: number }) {
  const [user, setUser] = useState<User | null>(null);

  if (!user) {
    const { data } = useSWR(`/api/user/${userId}`); // SAI: Hook trong conditional
    return null;
  }

  return <div>Content</div>;
}
```

**LÃ½ do:**
- React yÃªu cáº§u hooks pháº£i Ä‘Æ°á»£c gá»i theo Ä‘Ãºng thá»© tá»± trong má»—i láº§n render
- Hooks trong conditional sáº½ lÃ m thay Ä‘á»•i thá»© tá»± gá»i hooks â†’ gÃ¢y bugs
- GiÃºp React tá»‘i Æ°u hÃ³a render vÃ  quáº£n lÃ½ lifecycle hiá»‡u quáº£

**Náº¿u component quÃ¡ dÃ i:**
- **TÃ¡ch component**: Náº¿u cÃ³ quÃ¡ nhiá»u hooks (> 10 hooks), nÃªn tÃ¡ch thÃ nh nhiá»u components nhá» hÆ¡n

### 5.3. Cleanup trong useEffect

**Báº®T BUá»˜C** cleanup (unregister) táº¥t cáº£ timers, event listeners, subscriptions trong cleanup function cá»§a `useEffect`.

```typescript
// âœ… ÄÃšNG: Cleanup timers
useEffect(() => {
  const timeoutId = setTimeout(() => {
    // Do something
  }, 500);

  // Cleanup function
  return () => clearTimeout(timeoutId);
}, [dependencies]);

// âœ… ÄÃšNG: Cleanup event listeners
useEffect(() => {
  const handleClick = () => {
    // Handle click
  };

  document.addEventListener('click', handleClick);

  // Cleanup function
  return () => {
    document.removeEventListener('click', handleClick);
  };
}, []);

// âœ… ÄÃšNG: Cleanup subscriptions
useEffect(() => {
  const subscription = observable.subscribe((value) => {
    // Handle value
  });

  // Cleanup function
  return () => {
    subscription.unsubscribe();
  };
}, []);

// âœ… ÄÃšNG: Cleanup DOM manipulation
useEffect(() => {
  const lineChart = document?.querySelector('.lineChartObservationVolume');

  if (lineChart) {
    const timeoutId = setTimeout(() => {
      lineChart.scrollLeft = 100000;
    }, 500);

    // Cleanup function
    return () => clearTimeout(timeoutId);
  }
}, [dataList]);

// âŒ SAI: KhÃ´ng cleanup
useEffect(() => {
  const timer = setInterval(() => {
    // Do something
  }, 1000);
  // Thiáº¿u cleanup â†’ memory leak
}, []);
```

**Quy táº¯c:**
- **LuÃ´n cleanup**: Má»i side effect cáº§n cleanup function
- **Memory leaks**: KhÃ´ng cleanup sáº½ gÃ¢y memory leaks
- **Performance**: Cleanup giÃºp trÃ¡nh unnecessary operations

## 6. ğŸ› ï¸ Quy Táº¯c Tá»‘i Æ¯u HÃ³a vÃ  Refactoring

### 6.1. Loáº¡i Bá» Code Cháº¿t

**Báº®T BUá»˜C** loáº¡i bá»:
- Code Ä‘Ã£ comment (trá»« khi cÃ³ lÃ½ do rÃµ rÃ ng)
- Unused imports
- Unused variables/functions
- Dead code paths

```typescript
// âŒ SAI: Commented code
// function oldFunction() {
//   return 'old';
// }

// âœ… ÄÃšNG: XÃ³a code khÃ´ng dÃ¹ng
// Hoáº·c giáº£i thÃ­ch lÃ½ do náº¿u cáº§n giá»¯ láº¡i
// TODO: Remove after migration to new API (2024-12-31)
```

**Tools:**
- ESLint rule: `@typescript-eslint/no-unused-vars`
- Pre-commit hooks Ä‘á»ƒ check unused code

### 6.2. Sá»­ Dá»¥ng ES6+ Features

**Æ¯u tiÃªn** sá»­ dá»¥ng modern JavaScript:

```typescript
// âœ… ÄÃšNG: Arrow functions
const handleClick = () => { };

// âœ… ÄÃšNG: Destructuring vá»›i default values
const { name = 'Anonymous', email } = user;

// âœ… ÄÃšNG: Spread operator
const newState = { ...oldState, updated: true };

// âœ… ÄÃšNG: Rest parameters
function sum(...numbers: number[]) {
  return numbers.reduce((a, b) => a + b, 0);
}

// âœ… ÄÃšNG: Array methods
const filtered = items.filter(item => item.active);
const mapped = items.map(item => ({ ...item, processed: true }));

// âŒ SAI: Old syntax
function handleClick() { } // Arrow function preferred
for (let i = 0; i < items.length; i++) { } // Use forEach/map
```

### 6.3. Linter & Formatter

Dá»± Ã¡n sá»­ dá»¥ng:
- **ESLint**: Airbnb TypeScript config
- **Prettier**: Code formatting

#### 6.3.1. ESLint Rules

CÃ¡c rules quan trá»ng:
- `@typescript-eslint/consistent-type-imports`: Báº¯t buá»™c type imports
- `@typescript-eslint/no-unused-vars`: KhÃ´ng cho phÃ©p unused variables
- `@typescript-eslint/no-explicit-any`: TrÃ¡nh sá»­ dá»¥ng `any`

#### 6.3.2. Prettier Configuration

```json
{
  "trailingComma": "all",
  "tabWidth": 2,
  "semi": true
}
```

**Quy táº¯c:**
- **Semi-colons**: **Báº®T BUá»˜C** sá»­ dá»¥ng (`semi: true`)
- **Quotes**: Single quotes (theo Airbnb config)
- **Trailing commas**: LuÃ´n thÃªm trailing comma
- **Tab width**: 2 spaces

### 6.4. Code Organization

#### 6.4.1. Import Order

**Báº®T BUá»˜C** sáº¯p xáº¿p imports theo thá»© tá»±:
1. React vÃ  Next.js
2. Third-party libraries
3. Internal components
4. Internal utilities/hooks
5. Types
6. Styles

```typescript
// âœ… ÄÃšNG: Import order
// 1. React/Next.js
import { useState, useEffect } from "react";
import { useRouter } from "next/navigation";

// 2. Third-party
import { clsx } from "clsx";
import type { SWRConfiguration } from "swr";

// 3. Internal components
import Button from "../components/common/Button";
import Form from "../components/common/Form";

// 4. Internal utilities/hooks
import { useGetProjectsList } from "../lib/api/hooks/useGetProjectsList";

// 5. Types
import type { Project } from "../lib/api/generated";

// 6. Styles (náº¿u cÃ³)
import "./styles.css";
```

#### 6.4.2. Component Structure

**Báº®T BUá»˜C** tá»• chá»©c component theo thá»© tá»±:

```typescript
// âœ… ÄÃšNG: Component structure
"use client";

// 1. Imports
import { useState } from "react";
import type { ComponentProps } from "./types";

// 2. Types/Interfaces
interface ComponentProps {
  // ...
}

// 3. Constants (náº¿u cÃ³)
const DEFAULT_VALUE = 0;

// 4. Component
function Component({ prop1, prop2 }: ComponentProps) {
  // 4.1. Hooks
  const [state, setState] = useState();

  // 4.2. Derived state / computed values
  const computedValue = useMemo(() => {
    // ...
  }, [dependencies]);

  // 4.3. Event handlers
  const handleClick = useCallback(() => {
    // ...
  }, []);

  // 4.4. Effects
  useEffect(() => {
    // ...
  }, []);

  // 4.5. Early returns
  if (condition) return null;

  // 4.6. Render
  return (
    <div>
      {/* JSX */}
    </div>
  );
}

// 5. Exports
export default Component;
export type { ComponentProps };
```

### 6.5. Performance Best Practices

#### 6.5.1. Code Splitting

Sá»­ dá»¥ng dynamic imports cho:
- Heavy components
- Third-party libraries lá»›n
- Components chá»‰ render trong Ä‘iá»u kiá»‡n Ä‘áº·c biá»‡t

```typescript
// âœ… ÄÃšNG: Dynamic import
import dynamic from 'next/dynamic';

const HeavyChart = dynamic(() => import('./HeavyChart'), {
  loading: () => <Spinner />,
  ssr: false, // Náº¿u component khÃ´ng cáº§n SSR
});

// âŒ SAI: Import trá»±c tiáº¿p component náº·ng
import HeavyChart from './HeavyChart'; // Load ngay cáº£ khi khÃ´ng dÃ¹ng
```

#### 6.5.2. Image Optimization

**Báº®T BUá»˜C** sá»­ dá»¥ng Next.js Image component:

```typescript
// âœ… ÄÃšNG: Next.js Image
import Image from 'next/image';

<Image
  src="/logo.png"
  alt="Logo"
  width={200}
  height={200}
  priority // Cho above-the-fold images
/>

// âŒ SAI: HTML img tag
<img src="/logo.png" alt="Logo" />
```

## 7. ğŸ“‹ PR Review Checklist

### 7.1. Common Checks

- [ ] **No degradation**: Feature khÃ´ng lÃ m giáº£m performance hoáº·c phÃ¡ vá»¡ tÃ­nh nÄƒng hiá»‡n cÃ³
- [ ] **Can it be built**: Code cÃ³ thá»ƒ build thÃ nh cÃ´ng (`npm run build`)
- [ ] **No console & debugger**: KhÃ´ng cÃ³ `console.log`, `console.debug`, `debugger` trong code
- [ ] **Cover normal & abnormal cases**: Feature xá»­ lÃ½ cáº£ trÆ°á»ng há»£p bÃ¬nh thÆ°á»ng vÃ  báº¥t thÆ°á»ng (errors, edge cases)

### 7.2. ReactJS/NextJS Specific

- [ ] **Component size**: Components nhá» gá»n, JSX markup khÃ´ng quÃ¡ 50 dÃ²ng (SRP principle)
- [ ] **No linter errors**: Code khÃ´ng cÃ³ linter errors vÃ  Ä‘Ã£ format vá»›i Prettier
- [ ] **No React warnings**: KhÃ´ng cÃ³ React warnings trong console
- [ ] **Test re-render**: ÄÃ£ test re-render vá»›i React Developer Tools
- [ ] **DRY principle**: KhÃ´ng láº·p láº¡i code, Ä‘Ã£ extract thÃ nh helper functions/components
- [ ] **Code consistency**: Code tuÃ¢n thá»§ patterns hiá»‡n cÃ³ cá»§a dá»± Ã¡n
- [ ] **No unused props/imports**: KhÃ´ng cÃ³ unused props vÃ  imports
- [ ] **No hardcoded values**: Sá»­ dá»¥ng constants thay vÃ¬ hardcoded values
- [ ] **Custom hooks**: ÄÃ£ optimize vá»›i custom hooks khi cáº§n
- [ ] **Hook dependencies**: ÄÃ£ check dependencies cá»§a `useCallback`, `useEffect`, `useMemo`
- [ ] **Helper functions**: ÄÃ£ táº¡o helper functions cho code láº·p láº¡i
- [ ] **Exception handling**: ÄÃ£ implement proper error handling
- [ ] **Cleanup effects**: ÄÃ£ cleanup timers vÃ  event listeners trong `useEffect`
- [ ] **Hooks at top**: Hooks Ä‘Æ°á»£c khai bÃ¡o á»Ÿ Ä‘áº§u component
- [ ] **Multilingual**: ÄÃ£ implement multilingual handling (náº¿u project support)
- [ ] **General handling**: Xá»­ lÃ½ issues má»™t cÃ¡ch general vÃ  logical (khÃ´ng xá»­ lÃ½ riÃªng láº» trong tá»«ng page)

### 7.3. Package Management

- [ ] **Notify leader**: ÄÃ£ thÃ´ng bÃ¡o leader náº¿u thÃªm package má»›i tá»« NPM

### 7.4. Technical Checks

- [ ] TypeScript khÃ´ng cÃ³ errors
- [ ] ESLint khÃ´ng cÃ³ errors/warnings
- [ ] Prettier Ä‘Ã£ format code
- [ ] Components cÃ³ proper TypeScript types
- [ ] API calls sá»­ dá»¥ng custom hooks
- [ ] Error handling Ä‘Ã£ Ä‘Æ°á»£c implement
- [ ] Loading states Ä‘Ã£ Ä‘Æ°á»£c xá»­ lÃ½
- [ ] "use client" directive Ä‘Ã£ thÃªm cho client components
- [ ] Imports Ä‘Ã£ Ä‘Æ°á»£c sáº¯p xáº¿p Ä‘Ãºng thá»© tá»±
- [ ] Code tuÃ¢n thá»§ táº¥t cáº£ quy táº¯c trong file nÃ y

## 8. ğŸŒ Multilingual Support

Náº¿u project há»— trá»£ Ä‘a ngÃ´n ngá»¯, **Báº®T BUá»˜C** implement multilingual handling:

```typescript
// âœ… ÄÃšNG: Sá»­ dá»¥ng i18n cho text
import { useTranslation } from 'next-i18next';

function Component() {
  const { t } = useTranslation();

  return (
    <div>
      <h1>{t('common:title')}</h1>
      <p>{t('common:description')}</p>
    </div>
  );
}

// âŒ SAI: Hardcoded text
function Component() {
  return (
    <div>
      <h1>Title</h1> {/* âŒ Hardcoded */}
      <p>Description</p> {/* âŒ Hardcoded */}
    </div>
  );
}
```

**Quy táº¯c:**
- Táº¥t cáº£ user-facing text pháº£i Ä‘Æ°á»£c translate
- Sá»­ dá»¥ng translation keys thay vÃ¬ hardcoded strings
- Placeholder text cÅ©ng pháº£i Ä‘Æ°á»£c translate
- Error messages pháº£i Ä‘Æ°á»£c translate

## 9. ğŸ¯ General vÃ  Logical Handling

**Báº®T BUá»˜C** xá»­ lÃ½ issues má»™t cÃ¡ch general vÃ  logical:

```typescript
// âŒ SAI: Xá»­ lÃ½ riÃªng láº» trong tá»«ng page
function SomePage() {
  const searchParams = useSearchParams();
  const error = searchParams.get('error');

  if (error === 'unauthorized') {
    // Xá»­ lÃ½ unauthorized riÃªng trong page nÃ y
    showMessage('Unauthorized');
  }
  // ...
}

// âœ… ÄÃšNG: Xá»­ lÃ½ á»Ÿ táº§ng cao hÆ¡n (middleware, layout, hoáº·c error boundary)
// middleware.ts hoáº·c layout.tsx
if (error === 'unauthorized') {
  redirect('/login');
}
```

**Quy táº¯c:**
- **Authentication errors**: Xá»­ lÃ½ á»Ÿ middleware hoáº·c API layer
- **Authorization errors**: Redirect vá» login page á»Ÿ táº§ng server
- **Common errors**: Xá»­ lÃ½ á»Ÿ Error Boundary hoáº·c global error handler
- **KhÃ´ng xá»­ lÃ½ riÃªng láº»**: TrÃ¡nh xá»­ lÃ½ cÃ¹ng má»™t váº¥n Ä‘á» á»Ÿ nhiá»u nÆ¡i khÃ¡c nhau

## 10. ğŸ”„ Migration vÃ  Cáº£i Tiáº¿n

### 10.1. Cáº£i Tiáº¿n Code Hiá»‡n Táº¡i

Khi refactor code cÅ©, **Æ°u tiÃªn**:
1. Chuyá»ƒn Class Components â†’ Functional Components
2. ThÃªm TypeScript types cho untyped code
3. TÃ¡ch logic phá»©c táº¡p sang custom hooks
4. Chuyá»ƒn CSS modules â†’ Tailwind CSS
5. ThÃªm error handling cho API calls
6. Implement proper loading states

### 10.2. Strict TypeScript

**Má»¥c tiÃªu**: Báº­t `strict: true` trong `tsconfig.json`. Hiá»‡n táº¡i `strict: false` Ä‘á»ƒ tÆ°Æ¡ng thÃ­ch vá»›i code cÅ©.

**Káº¿ hoáº¡ch**:
- Dáº§n dáº§n fix type errors
- ThÃªm explicit types cho untyped code
- Loáº¡i bá» `any` types
- Enable strict mode khi Ä‘Ã£ sáºµn sÃ ng

## 11. ğŸ“š TÃ i Liá»‡u Tham Kháº£o

- [Next.js Documentation](https://nextjs.org/docs)
- [React Documentation](https://react.dev)
- [TypeScript Handbook](https://www.typescriptlang.org/docs/)
- [SWR Documentation](https://swr.vercel.app)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)
- [ESLint Rules](https://eslint.org/docs/rules/)
- [Airbnb JavaScript Style Guide](https://github.com/airbnb/javascript)

---

**LÆ°u Ã½**: File nÃ y lÃ  **living document** vÃ  sáº½ Ä‘Æ°á»£c cáº­p nháº­t thÆ°á»ng xuyÃªn. Má»i thay Ä‘á»•i cáº§n Ä‘Æ°á»£c tháº£o luáº­n vÃ  approve bá»Ÿi team trÆ°á»›c khi Ã¡p dá»¥ng.
